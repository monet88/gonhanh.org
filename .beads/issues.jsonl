{"id":"gonhanh.org-1p8","title":"Create UpdateService.cs","description":"Create service to check GitHub Releases API for new versions. Async, non-blocking, silent fail on error.","design":"File: Services/UpdateService.cs (NEW)\n\nStatic HttpClient with User-Agent header, 10s timeout.\n\nProperties:\n- LatestVersion (string?)\n- ReleaseUrl (string?)\n- UpdateAvailable (bool)\n\nMethod CheckForUpdatesAsync():\n1. GET https://api.github.com/repos/khaphanspace/gonhanh.org/releases/latest\n2. Parse JSON: tag_name, html_url\n3. Compare versions using IsNewerVersion()\n4. Set UpdateAvailable = true if newer\n\nIsNewerVersion(latest, current):\n- Split by '.', compare major.minor.patch\n- Return true if latest \u003e current","acceptance_criteria":"- [ ] GET https://api.github.com/repos/khaphanspace/gonhanh.org/releases/latest returns 200\n- [ ] Parses tag_name and html_url from JSON response\n- [ ] IsNewerVersion('1.0.89', '1.0.88') returns true\n- [ ] IsNewerVersion('1.0.88', '1.0.88') returns false\n- [ ] Network timeout (\u003e10s) sets UpdateAvailable=false silently\n- [ ] Malformed JSON sets UpdateAvailable=false silently","status":"closed","priority":3,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-25T01:02:55.2139938+07:00","updated_at":"2025-12-25T10:45:41.2998565+07:00","closed_at":"2025-12-25T10:45:41.2998565+07:00","close_reason":"Closed","labels":["api","github","phase-3"],"dependencies":[{"issue_id":"gonhanh.org-1p8","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T01:03:17.333675+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-1p8","depends_on_id":"gonhanh.org-bxb","type":"blocks","created_at":"2025-12-25T01:03:17.7889178+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-2d5","title":"Add ShortcutEnabled to SettingsService","description":"Add ShortcutEnabled property to SettingsService for persistence in Windows Registry.","design":"File: Services/SettingsService.cs\n\nAdd:\n- const KeyShortcutEnabled = 'ShortcutEnabled'\n- public bool ShortcutEnabled { get; set; } = true;\n\nIn Load(): ShortcutEnabled = ((int)(key.GetValue(KeyShortcutEnabled, 1) ?? 1)) == 1;\nIn Save(): key.SetValue(KeyShortcutEnabled, ShortcutEnabled ? 1 : 0, RegistryValueKind.DWord);","acceptance_criteria":"- [ ] ShortcutEnabled property exists\n- [ ] Defaults to true\n- [ ] Persists to Registry on Save()\n- [ ] Loads from Registry on Load()","status":"closed","priority":1,"issue_type":"task","estimated_minutes":15,"created_at":"2025-12-25T00:58:49.2836738+07:00","updated_at":"2025-12-25T10:36:28.6916236+07:00","closed_at":"2025-12-25T10:36:28.6916236+07:00","close_reason":"Closed","labels":["phase-1","settings"],"dependencies":[{"issue_id":"gonhanh.org-2d5","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T00:59:13.1807687+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-4kh","title":"Add Ctrl+Shift hotkey toggle","description":"Detect Ctrl+Shift combo on key-up to toggle IsEnabled state. Don't block the combo, just react to it.","design":"File: Core/KeyboardHook.cs\n\nAdd fields:\n- _ctrlPressed, _shiftPressed, _hotkeyTriggered (bool)\n- HotkeyToggle event (EventHandler)\n\nIn HookCallback:\n1. Track WM_KEYDOWN for VK_CONTROL and VK_SHIFT\n2. On WM_KEYUP: if both were pressed and no letter key in between -\u003e fire HotkeyToggle\n3. Reset state after firing\n\nKey: Fire on key-up to avoid blocking. Skip if any letter pressed during combo.","acceptance_criteria":"- [ ] Press Ctrl+Shift (no other key) → toggles IsEnabled\n- [ ] Press Ctrl+Shift+C (letter) → does NOT toggle (shortcut passes through)\n- [ ] TrayIcon shows 'V' when enabled, 'E' when disabled after toggle\n- [ ] No infinite loop (injected keys not re-processed)\n- [ ] State persists after toggle (RustBridge.SetEnabled called)","status":"closed","priority":1,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-25T00:56:51.1002377+07:00","updated_at":"2025-12-25T10:41:27.8597523+07:00","closed_at":"2025-12-25T10:41:27.8597523+07:00","close_reason":"Closed","labels":["keyboard","phase-1"],"dependencies":[{"issue_id":"gonhanh.org-4kh","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T00:57:38.2340297+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-9d4","title":"Add Settings menu item to TrayIcon","description":"Add 'Cài đặt' menu item that fires OnSettingsRequested event to open the settings popup.","design":"File: Views/TrayIcon.cs\n\nAdd:\n- public event Action? OnSettingsRequested;\n\nIn Initialize() before About item:\nvar settingsItem = new ToolStripMenuItem('Cài đặt');\nsettingsItem.Click += (s, e) =\u003e OnSettingsRequested?.Invoke();\n_contextMenu.Items.Add(settingsItem);","acceptance_criteria":"- [ ] Menu shows 'Cài đặt' item\n- [ ] Click fires OnSettingsRequested event","status":"closed","priority":2,"issue_type":"task","estimated_minutes":20,"created_at":"2025-12-25T01:01:29.6529404+07:00","updated_at":"2025-12-25T10:43:35.6170871+07:00","closed_at":"2025-12-25T10:43:35.6170871+07:00","close_reason":"Closed","labels":["phase-2","trayicon"],"dependencies":[{"issue_id":"gonhanh.org-9d4","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T01:01:51.1398599+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-9d4","depends_on_id":"gonhanh.org-jrs","type":"blocks","created_at":"2025-12-25T01:01:51.5757215+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-9lg","title":"Epic: Windows Completion","description":"Complete Windows GoNhanh to achieve feature parity with macOS. Includes: Ctrl+Shift hotkey, menu toggles, settings popup, update checker. Excludes: per-app mode, ARM64, installer. Platform: platforms/windows/GoNhanh/ (.NET 8/WPF)","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-25T00:54:01.5240673+07:00","updated_at":"2025-12-25T10:46:13.3526649+07:00","closed_at":"2025-12-25T10:46:13.3526649+07:00","close_reason":"All child tasks completed"}
{"id":"gonhanh.org-bxb","title":"Wire up Settings popup in App.xaml.cs","description":"Connect OnSettingsRequested event to show SettingsPopup, wire popup events to settings handlers, update tray on close.","design":"File: App.xaml.cs\n\nIn OnStartup:\n_trayIcon.OnSettingsRequested += ShowSettings;\n\nNew method ShowSettings():\n1. Create SettingsPopup(_settings)\n2. Wire events: OnMethodChanged, OnModernToneChanged, OnShortcutChanged, OnAutoStartChanged\n3. popup.ShowDialog()\n4. After close: _trayIcon.UpdateState()\n\nNew method ChangeAutoStart(bool):\n_settings.AutoStart = autoStart;\n_settings.Save();","acceptance_criteria":"- [ ] Menu click opens popup\n- [ ] Popup changes apply immediately\n- [ ] TrayIcon updates on popup close\n- [ ] AutoStart setting persists","status":"closed","priority":2,"issue_type":"task","estimated_minutes":25,"created_at":"2025-12-25T01:02:14.0143844+07:00","updated_at":"2025-12-25T10:44:06.2542097+07:00","closed_at":"2025-12-25T10:44:06.2542097+07:00","close_reason":"Already implemented as part of Phase 2 tasks","labels":["integration","phase-2"],"dependencies":[{"issue_id":"gonhanh.org-bxb","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T01:02:32.2098202+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-bxb","depends_on_id":"gonhanh.org-w6k","type":"blocks","created_at":"2025-12-25T01:02:32.6521195+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-bxb","depends_on_id":"gonhanh.org-9d4","type":"blocks","created_at":"2025-12-25T01:02:33.0976942+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-d93","title":"Add update menu item to TrayIcon","description":"Add dynamic menu item 'Có bản mới vX.X.X →' that appears when update is available. Opens browser to release page on click.","design":"File: Views/TrayIcon.cs\n\nAdd field:\n- _updateItem (ToolStripMenuItem?)\n\nAdd method ShowUpdateItem(string version, string url):\n1. Remove existing _updateItem if any\n2. Create new item with blue text color\n3. Click handler opens url via Process.Start\n4. Insert at index 2 (after header + separator)\n\nOpenUrl helper:\nProcess.Start(new ProcessStartInfo { FileName = url, UseShellExecute = true })","acceptance_criteria":"- [ ] ShowUpdateItem('1.0.89', 'https://...') adds menu item at index 2\n- [ ] Menu item text: 'Có bản mới v1.0.89 →'\n- [ ] Menu item ForeColor is RGB(37,99,235) blue\n- [ ] Click opens default browser to release URL\n- [ ] Menu item not visible if ShowUpdateItem never called\n- [ ] Calling ShowUpdateItem twice replaces old item (no duplicates)","status":"closed","priority":3,"issue_type":"task","estimated_minutes":25,"created_at":"2025-12-25T01:03:44.1271055+07:00","updated_at":"2025-12-25T10:45:58.2050465+07:00","closed_at":"2025-12-25T10:45:58.2050465+07:00","close_reason":"Already implemented in UpdateService task","labels":["phase-3","trayicon"],"dependencies":[{"issue_id":"gonhanh.org-d93","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T01:04:09.8377437+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-d93","depends_on_id":"gonhanh.org-1p8","type":"blocks","created_at":"2025-12-25T01:04:10.2962318+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-jrs","title":"Wire up Phase 1 events in App.xaml.cs","description":"Connect hotkey and menu toggle events to App.xaml.cs. Update TrayIcon and RustBridge on state changes.","design":"File: App.xaml.cs\n\nIn OnStartup:\n1. _keyboardHook.HotkeyToggle += OnHotkeyToggle;\n2. _trayIcon.OnShortcutChanged += ChangeShortcutEnabled;\n3. _trayIcon.OnModernToneChanged += ChangeModernTone;\n4. _trayIcon.UpdateToggles(_settings.ShortcutEnabled, _settings.UseModernTone);\n\nAdd methods:\n- OnHotkeyToggle: toggle IsEnabled, save, update RustBridge and TrayIcon\n- ChangeShortcutEnabled: save setting (skip RustBridge if no FFI)\n- ChangeModernTone: save setting, call RustBridge.SetModernTone()","acceptance_criteria":"- [ ] Ctrl+Shift toggles enabled state\n- [ ] Menu checkbox changes persist\n- [ ] TrayIcon updates on state change\n- [ ] RustBridge synced with settings","status":"closed","priority":1,"issue_type":"task","estimated_minutes":30,"created_at":"2025-12-25T00:59:13.6619581+07:00","updated_at":"2025-12-25T10:41:49.402921+07:00","closed_at":"2025-12-25T10:41:49.402921+07:00","close_reason":"Already implemented when wiring up Phase 1 tasks","labels":["integration","phase-1"],"dependencies":[{"issue_id":"gonhanh.org-jrs","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T00:59:37.7517409+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-jrs","depends_on_id":"gonhanh.org-4kh","type":"blocks","created_at":"2025-12-25T00:59:38.2075831+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-jrs","depends_on_id":"gonhanh.org-w66","type":"blocks","created_at":"2025-12-25T00:59:38.6514359+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-jrs","depends_on_id":"gonhanh.org-2d5","type":"blocks","created_at":"2025-12-25T00:59:39.1042626+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-puu","title":"Create SettingsPopup.xaml UI","description":"Create WPF borderless window with settings UI: input method dropdown, checkboxes for modern tone/shortcut/autostart, version info.","design":"File: Views/SettingsPopup.xaml (NEW)\n\nWPF Window with:\n- WindowStyle=None, AllowsTransparency=True, Background=Transparent\n- Border with CornerRadius=8, DropShadowEffect\n- StackPanel with:\n  - Header: 'Cài đặt GoNhanh'\n  - ComboBox: Telex/VNI\n  - CheckBox: 'Kiểu gõ mới (oà)'\n  - CheckBox: 'Bật viết tắt'\n  - CheckBox: 'Khởi động cùng Windows'\n  - TextBlock: 'Phím tắt: Ctrl+Shift'\n  - TextBlock: version from AppMetadata\n\nSize: 260x220, positioned near system tray (WorkArea.Right - Width - 10)","acceptance_criteria":"- [ ] Window has no titlebar (WindowStyle=None)\n- [ ] Border has 8px corner radius\n- [ ] DropShadowEffect visible (BlurRadius=10)\n- [ ] ComboBox shows 'Telex' and 'VNI' options\n- [ ] 3 checkboxes present: modern tone, shortcut, autostart\n- [ ] 'Phím tắt: Ctrl+Shift' text visible\n- [ ] Version text shows 'Phiên bản: vX.X.X'","status":"closed","priority":2,"issue_type":"task","estimated_minutes":60,"created_at":"2025-12-25T01:00:05.6440535+07:00","updated_at":"2025-12-25T10:43:35.6145067+07:00","closed_at":"2025-12-25T10:43:35.6145067+07:00","close_reason":"Closed","labels":["phase-2","ui","wpf"],"dependencies":[{"issue_id":"gonhanh.org-puu","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T01:00:23.8099078+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-puu","depends_on_id":"gonhanh.org-jrs","type":"blocks","created_at":"2025-12-25T01:00:24.2904648+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-w66","title":"Add menu toggles for shortcut and modern tone","description":"Add checkbox menu items for 'Bật viết tắt' (shortcut enabled) and 'Kiểu gõ mới (oà)' (modern tone). Sync state with RustBridge and SettingsService.","design":"File: Views/TrayIcon.cs\n\nAdd fields:\n- _shortcutItem, _modernToneItem (ToolStripMenuItem)\n- OnShortcutChanged, OnModernToneChanged (Action\u003cbool\u003e events)\n\nIn Initialize() after VNI item:\n1. Add separator\n2. Add _modernToneItem with CheckOnClick=true\n3. Add _shortcutItem with CheckOnClick=true\n\nAdd UpdateToggles(bool shortcut, bool modernTone) method to set initial checkbox states.","acceptance_criteria":"- [ ] Menu shows 'Kiểu gõ mới (oà)' checkbox\n- [ ] Menu shows 'Bật viết tắt' checkbox\n- [ ] Checkboxes reflect current settings on startup\n- [ ] Click fires corresponding event","status":"closed","priority":1,"issue_type":"task","estimated_minutes":30,"created_at":"2025-12-25T00:58:03.6088271+07:00","updated_at":"2025-12-25T10:41:27.8628045+07:00","closed_at":"2025-12-25T10:41:27.8628045+07:00","close_reason":"Closed","labels":["phase-1","trayicon"],"dependencies":[{"issue_id":"gonhanh.org-w66","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T00:58:23.4422622+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-w6k","title":"Create SettingsPopup.xaml.cs code-behind","description":"Implement code-behind for SettingsPopup: load settings, handle events, position near tray, close on deactivate/Escape.","design":"File: Views/SettingsPopup.xaml.cs (NEW)\n\nConstructor:\n1. InitializeComponent()\n2. LoadSettings() from SettingsService\n3. PositionNearTray() using SystemParameters.WorkArea\n\nEvents to fire:\n- OnMethodChanged (Action\u003cInputMethod\u003e)\n- OnModernToneChanged (Action\u003cbool\u003e)\n- OnShortcutChanged (Action\u003cbool\u003e)\n- OnAutoStartChanged (Action\u003cbool\u003e)\n\nHandle:\n- Window_Deactivated -\u003e Close()\n- OnKeyDown(Escape) -\u003e Close()\n- ComboBox/CheckBox changed -\u003e fire events (skip if _isInitializing)","acceptance_criteria":"- [ ] Settings load on open\n- [ ] Events fire on change\n- [ ] Window closes on click outside\n- [ ] Window closes on Escape\n- [ ] No double-fire during init","status":"closed","priority":2,"issue_type":"task","estimated_minutes":45,"created_at":"2025-12-25T01:00:48.8649522+07:00","updated_at":"2025-12-25T10:43:53.2547876+07:00","closed_at":"2025-12-25T10:43:53.2547876+07:00","close_reason":"Already implemented as part of puu task","labels":["phase-2","wpf"],"dependencies":[{"issue_id":"gonhanh.org-w6k","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T01:01:08.9580623+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-w6k","depends_on_id":"gonhanh.org-puu","type":"blocks","created_at":"2025-12-25T01:01:09.3885895+07:00","created_by":"unknown"}]}
{"id":"gonhanh.org-w7d","title":"Wire up update checker in App.xaml.cs","description":"Call UpdateService on startup (fire-and-forget), show update menu item if available.","design":"File: App.xaml.cs\n\nAdd field:\n- _updateService = new UpdateService()\n\nIn OnStartup (after tray init):\n_ = CheckForUpdatesAsync();  // fire and forget\n\nNew async method CheckForUpdatesAsync():\n1. await _updateService.CheckForUpdatesAsync()\n2. if UpdateAvailable \u0026\u0026 LatestVersion != null \u0026\u0026 ReleaseUrl != null:\n   _trayIcon.ShowUpdateItem(LatestVersion, ReleaseUrl)","acceptance_criteria":"- [ ] Update check runs on startup\n- [ ] Check is async (non-blocking)\n- [ ] Menu item appears if update found\n- [ ] No crash on network failure","status":"closed","priority":3,"issue_type":"task","estimated_minutes":20,"created_at":"2025-12-25T01:04:42.9518096+07:00","updated_at":"2025-12-25T10:46:12.9429594+07:00","closed_at":"2025-12-25T10:46:12.9429594+07:00","close_reason":"Already implemented in UpdateService task","labels":["integration","phase-3"],"dependencies":[{"issue_id":"gonhanh.org-w7d","depends_on_id":"gonhanh.org-9lg","type":"parent-child","created_at":"2025-12-25T01:04:58.5807503+07:00","created_by":"unknown"},{"issue_id":"gonhanh.org-w7d","depends_on_id":"gonhanh.org-d93","type":"blocks","created_at":"2025-12-25T01:04:59.0238037+07:00","created_by":"unknown"}]}
